<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–í–∞—à–∞ –≥–∞–ª–µ—Ä–µ—è</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
    padding: 0;
    margin: 0;
    font-family: sans-serif;
    background-color: #f9f9f9;
  }

  .notice-bar {
    background-color: #201c1c;
    color: #999;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 1000;
  }

  .notice-bar strong {
    color: white;
    font-weight: 500;
  }

  /* –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø–æ–¥ —Ö–µ–¥–µ—Ä */
  #header-placeholder {
    height: 45px; /* —Ç–∞–∫–∞—è –∂–µ –∫–∞–∫ —É .topbar */
  }

  /* –û—Å–Ω–æ–≤–Ω–æ–π —Ö–µ–¥–µ—Ä */
  .topbar {
    height: 45px;
    background: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 35px;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    font-family: sans-serif;
    position: relative;
    z-index: 998;
    transition: all 0.2s ease;
  }

  /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
  .topbar.fixed {
    position: fixed;
    top: 30px; /* –≤—ã—Å–æ—Ç–∞ notice-bar */
    left: 0;
    width: 100%;
    z-index: 999;
  }

  /* –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥ –æ–±–ª–æ–∂–∫–æ–π */
  .highlight-box {
    position: relative;
    width: 100%;
    height: 100vh;
    max-height: 1080px;
    overflow: hidden;
    margin-bottom: 20px;
  }

  .highlight-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(60%);
  }

  .overlay-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    text-align: center;
  }

  .overlay-text h1 {
    font-size: 32px;
    margin: 0;
  }

  .overlay-text p {
    font-size: 16px;
    margin: 10px 0 0;
  }

  .topbar .left {
    font-size: 16px;
    color: #333;
    font-weight: 500;
  }

  .topbar .right img {
    height: 25px;
    vertical-align: middle;
  }

  /* –ì–∞–ª–µ—Ä–µ—è */
  #photo-container {
    column-count: 4;
    column-gap: 12px;
    padding: 10px;
  }

  .photo-box {
    break-inside: avoid;
    margin-bottom: 12px;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    position: relative;
  }

  .photo-box img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 10px;
  }

  .download-button {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    text-align: center;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 10px;
    font-size: 14px;
    opacity: 0;
    transition: opacity 0.3s ease;
    text-decoration: none;
  }

  .photo-box:hover .download-button {
    opacity: 1;
  }
  </style>

</head>
<body>

  <div class="notice-bar">
    –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–æ <strong> 01.09.2025</strong>
  </div>

  <div class="highlight-box">
    <img id="cover-image" src="" alt="–û–±–ª–æ–∂–∫–∞" />
    <div class="overlay-text">
      <h1 id="session-title">...</h1>
      <p id="session-date">...</p>
    </div>
  </div>

  <!-- –ê–∫—Ü–µ–Ω—Ç–Ω–æ–µ —Ñ–æ—Ç–æ -->
  <div class="highlight-box">...</div>

  <!-- –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä –ø–æ–¥ —Ö–µ–¥–µ—Ä (–≤—ã—Å–æ—Ç–∞ = header) -->
  <div id="header-placeholder"></div>

  <!-- –û–¥–∏–Ω —Ö–µ–¥–µ—Ä -->
  <header class="header" id="main-header">
    <div class="left">Kovalev Nazar</div>
    <div class="right"><img src="download.svg" alt="–°–∫–∞—á–∞—Ç—å"></div>
  </header>

  <div id="photo-container"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");
    const container = document.getElementById("photo-container");

    if (!code) {
      container.innerHTML = "<p>–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –Ω–µ —É–∫–∞–∑–∞–Ω.</p>";
    } else {
      fetch(`/api/photos/${code}`)
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            document.getElementById("cover-image").src = data.cover || "";
            document.getElementById("session-title").textContent = data.title || "–§–æ—Ç–æ—Å–µ—Å—Å–∏—è";
            document.getElementById("session-date").textContent = data.date || "";

            data.urls.forEach(url => {
              const box = document.createElement("div");
              box.className = "photo-box";

              const img = document.createElement("img");
              img.src = url;
              img.alt = "–§–æ—Ç–æ";

              const download = document.createElement("a");
              download.href = url;
              download.download = "";
              download.className = "download-button";
              download.textContent = "üì• –°–∫–∞—á–∞—Ç—å";

              box.appendChild(img);
              box.appendChild(download);
              container.appendChild(box);
            });
          } else {
            container.innerHTML = "<p>–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–¥–∞.</p>";
          }
        })
        .catch(err => {
          container.innerHTML = "<p>–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π.</p>";
          console.error(err);
        });
    }

    const header = document.getElementById('main-header');
    const placeholder = document.getElementById('header-placeholder');

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã—Å–æ—Ç—É –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∞ = –≤—ã—Å–æ—Ç–µ —Ö–µ–¥–µ—Ä–∞
    placeholder.style.height = `${header.offsetHeight}px`;

    const observer = new IntersectionObserver(([entry]) => {
      if (!entry.isIntersecting) {
        header.classList.add('fixed');
      } else {
        header.classList.remove('fixed');
      }
    }, {
      threshold: 0,
      rootMargin: "-30px 0px 0px 0px" // —É—á–∏—Ç—ã–≤–∞–µ–º notice-bar
    });

    observer.observe(placeholder);

  </script>
</body>
</html>